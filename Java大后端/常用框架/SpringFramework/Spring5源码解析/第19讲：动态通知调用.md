```java
package org.springframework.aop.framework.autoproxy;

import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.springframework.aop.Advisor;
import org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator;
import org.springframework.aop.framework.ProxyFactory;
import org.springframework.aop.framework.ReflectiveMethodInvocation;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.ConfigurationClassPostProcessor;
import org.springframework.context.support.GenericApplicationContext;

import java.lang.reflect.Field;
import java.util.List;

public class A19 {

    @Aspect
        static class MyAspect {
            @Before("execution(* foo(..))") // é™æ€é€šçŸ¥è°ƒç”¨ï¼Œä¸å¸¦å‚æ•°ç»‘å®šï¼Œæ‰§è¡Œæ—¶ä¸éœ€è¦åˆ‡ç‚¹
            public void before1() {
                System.out.println("before1");
            }

            @Before("execution(* foo(..)) && args(x)") // åŠ¨æ€é€šçŸ¥è°ƒç”¨ï¼Œéœ€è¦å‚æ•°ç»‘å®šï¼Œæ‰§è¡Œæ—¶è¿˜éœ€è¦åˆ‡ç‚¹å¯¹è±¡
            public void before2(int x) {
                System.out.printf("before2(%d)%n", x);
            }
        }

    static class Target {
        public void foo(int x) {
            System.out.printf("target foo(%d)%n", x);
        }
    }

    @Configuration
        static class MyConfig {
            @Bean
            AnnotationAwareAspectJAutoProxyCreator proxyCreator() {
                return new AnnotationAwareAspectJAutoProxyCreator();
            }

            @Bean
            public MyAspect myAspect() {
                return new MyAspect();
            }
        }

    public static void main(String[] args) throws Throwable {
        GenericApplicationContext context = new GenericApplicationContext();
        context.registerBean(ConfigurationClassPostProcessor.class);
        context.registerBean(MyConfig.class);
        context.refresh();

        AnnotationAwareAspectJAutoProxyCreator creator = context.getBean(AnnotationAwareAspectJAutoProxyCreator.class);
        List<Advisor> list = creator.findEligibleAdvisors(Target.class, "target");

        Target target = new Target();
        ProxyFactory factory = new ProxyFactory();
        factory.setTarget(target);
        factory.addAdvisors(list);
        Object proxy = factory.getProxy(); // è·å–ä»£ç†

        List<Object> interceptorList = factory.getInterceptorsAndDynamicInterceptionAdvice(Target.class.getMethod("foo", int.class), Target.class);
        for (Object o : interceptorList) {
            showDetail(o);
        }

        System.out.println(">>>>>>>>>>>>>>>>>>>>>>>>>>");
        ReflectiveMethodInvocation invocation = new ReflectiveMethodInvocation(
            proxy, target, Target.class.getMethod("foo", int.class), new Object[]{100}, Target.class, interceptorList
        ) {};

        invocation.proceed();

 

    public static void showDetail(Object o) {
        try {
            Class<?> clazz = Class.forName("org.springframework.aop.framework.InterceptorAndDynamicMethodMatcher");
                if (clazz.isInstance(o)) {
                Field methodMatcher = clazz.getDeclaredField("methodMatcher");
                methodMatcher.setAccessible(true);
                Field methodInterceptor = clazz.getDeclaredField("interceptor");
                methodInterceptor.setAccessible(true);
                System.out.println("ç¯ç»•é€šçŸ¥å’Œåˆ‡ç‚¹ï¼š" + o);
                System.out.println("\tåˆ‡ç‚¹ä¸ºï¼š" + methodMatcher.get(o));
                System.out.println("\té€šçŸ¥ä¸ºï¼š" + methodInterceptor.get(o));
                } else {
                System.out.println("æ™®é€šç¯ç»•é€šçŸ¥ï¼š" + o);
                }
                } catch (Exception e) {
                e.printStackTrace();
                }
                }
                }
```
# æ”¶è·ğŸ’¡

1. é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥
2. æ‰€è°“åŠ¨æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ DynamicInterceptionAdvice éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶å› ä¸ºè¦ä¸ºé€šçŸ¥æ–¹æ³•ç»‘å®šå‚æ•°ï¼Œè¿˜éœ€å†æ¬¡åˆ©ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼
3. åŠ¨æ€é€šçŸ¥è°ƒç”¨å¤æ‚ç¨‹åº¦é«˜ï¼Œæ€§èƒ½è¾ƒä½
